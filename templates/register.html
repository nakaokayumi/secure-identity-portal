<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Profile | Secure IAM Portal</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap');
        body, input, button, .sub { font-family: 'JetBrains Mono', monospace !important; }
        
        .blink { animation: blinker 1.5s linear infinite; color: #ef4444; }
        @keyframes blinker { 50% { opacity: 0; } }
        
        .access-note {
            border-left: 3px solid #ef4444;
            background: rgba(239, 68, 68, 0.05);
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
    </style>
</head>
<body class="register-page">
    <div class="nav">
        <a href="{{ url_for('home') }}">Project Home</a>
        <span class="pill">Encryption Active</span>
    </div>

    <div class="container">
        <div class="card">
            <h1>CREATE PROFILE</h1>
            <span class="sub">Register new identity in the secure database</span>

            <div class="access-note">
                <p style="color: #ef4444; font-weight: bold; font-size: 11px; margin-bottom: 8px;">
                    <span class="blink">●</span> IDENTITY PROTOCOL ADVISORY
                </p>
                <p style="color: #8e8e9f; font-size: 13px; border-left: 2px solid #ef4444; padding-left: 10px;">
                    <strong>[SANDBOX_ACCESS]:</strong> admin@secure.io | Red-Astronauts-Eating-3.14159!<br>
                    <em>Note: Sandbox is Read-Only. <strong>Register</strong> for Full Persistence & Live Audit Logs.</em>
                </p>
            </div>

            <form id="regForm" action="{{ url_for('register') }}" method="POST">
                <label>Full Name</label>
                <input type="text" name="full_name" class="input" placeholder="Guest User" required>

                <label>Email Address</label>
                <input type="email" id="emailInput" name="email" class="input" placeholder="tester@secure.io" required>

                <label>Access Key (Password)</label>
                <input type="password" id="password" name="password" class="input" placeholder="••••••••" required>

                <div class="strength-container">
                    <div id="strength-bar" class="strength-bar" style="height: 4px; width: 0; transition: 0.3s;"></div>
                </div>
                <span id="strength-text" class="sub" style="margin-top: 5px; font-size: 10px;">Security Level: Weak</span>

                <button type="submit" id="submitBtn" class="btn-primary" style="margin-top: 20px;">Initialize Account</button>
            </form>

            <div class="footer-links">
                <p><a href="{{ url_for('login') }}">Already have an account? Login here</a></p>
            </div>
        </div>
    </div>

    <div id="error-popup" class="popup-overlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); justify-content:center; align-items:center;">
        <div class="popup-card" style="background:#0d0d12; border:1px solid #ef4444; padding:30px; text-align:center;">
            <h3 style="color: #ef4444; margin-bottom: 10px;">AUTHENTICATION ERROR</h3>
            <p class="sub">This identity is already active in our database.</p>
            <button onclick="closePopup()" class="btn-primary" style="margin-top: 15px;">RETRY</button>
        </div>
    </div>

    <script>
        const form = document.getElementById('regForm');
        const emailInput = document.getElementById('emailInput');
        const submitBtn = document.getElementById('submitBtn');
        const passwordInput = document.getElementById('password');
        const strengthBar = document.getElementById('strength-bar');
        const strengthText = document.getElementById('strength-text');
        const popup = document.getElementById('error-popup');

        passwordInput.addEventListener('input', () => {
            const val = passwordInput.value;
            let strength = 0;
            if (val.length > 5) strength += 25;
            if (val.length > 8) strength += 25;
            if (/[A-Z]/.test(val)) strength += 25;
            if (/[!@#$%^&*]/.test(val)) strength += 25;
            
            strengthBar.style.width = strength + '%';
            
            if (strength <= 25) {
                strengthBar.style.backgroundColor = "#ef4444";
                strengthText.innerText = "Security Level: Weak";
            } else if (strength <= 75) {
                strengthBar.style.backgroundColor = "#eab308";
                strengthText.innerText = "Security Level: Medium";
            } else {
                strengthBar.style.backgroundColor = "#10b981";
                strengthText.innerText = "Security Level: Strong";
            }
        });

        function closePopup() { popup.style.display = 'none'; }
    </script>
</body>
</html>


